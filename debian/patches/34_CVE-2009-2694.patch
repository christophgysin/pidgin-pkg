#
# old_revision [595994cbd9222742a876670d7503f564822c34c1]
#
# patch "libpurple/protocols/msn/slplink.c"
#  from [04fd3b72538b01c4ec83fa596a37340af5f19d3c]
#    to [bcb3eb4224e4e0b61b948f6a6ce767395058fa7f]
#
============================================================
--- libpurple/protocols/msn/slplink.c	04fd3b72538b01c4ec83fa596a37340af5f19d3c
+++ libpurple/protocols/msn/slplink.c	bcb3eb4224e4e0b61b948f6a6ce767395058fa7f
@@ -441,6 +441,7 @@ msn_slplink_send_ack(MsnSlpLink *slplink
 	slpmsg->info = "SLP ACK";
 
 	msn_slplink_send_slpmsg(slplink, slpmsg);
+	msn_slpmsg_destroy(slpmsg);
 }
 
 static void
@@ -578,7 +579,7 @@ msn_slplink_process_msg(MsnSlpLink *slpl
 		/* fseek(slpmsg->fp, offset, SEEK_SET); */
 		len = fwrite(data, 1, len, slpmsg->fp);
 	}
-	else if (slpmsg->size)
+	else if (slpmsg->size && slpmsg->buffer)
 	{
 		if (G_MAXSIZE - len < offset || (offset + len) > slpmsg->size)
 		{
